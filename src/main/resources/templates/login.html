<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/default}">

<th:block layout:fragment="content">
    <form id="frm">
        <p>
            <input type="text" id="loginId" name="loginId" placeholder="아이디"/>
        </p>
        <p>
            <input type="password" id="password" name="password" placeholder="패스워드"/>
        </p>
        <p>
            <input type="button" value="로그인" onclick="login()" />
            <input type="button" value="회원가입" onclick="window.location.href = '/join'" />
        </p>
    </form>
</th:block>

<th:block layout:fragment="script">
    <script>
        const login = async() => {
            try {
                let res = await ajax.post(
                    "/loginProc",
                    $("#frm").serializeObject(),
                    {'Content-type': 'x-www-form-urlencoded'}
                );
                if(res.status === 0) {
                    window.location.href = "/";
                }
            } catch (ex) {
                alert("로그인아이디와 비밀번호를 확인해주세요.");
                console.error(ex);
            }
        }
    </script>
</th:block>
</html>